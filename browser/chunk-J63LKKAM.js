import{a as q}from"./chunk-ANKGLE3F.js";import{a as D}from"./chunk-FRMY5WGX.js";import{a as ne,b as oe}from"./chunk-LQE76MLN.js";import{a as k}from"./chunk-XBBG2RYN.js";import{b as N,d as B}from"./chunk-MYRLHBHN.js";import{a as j,b as L,c as M,d as W,e as G,f as z,g as U,h as X,j as Q,l as Y,m as $,q as J,r as H,s as K,t as Z,u as ee,v as te,w as ie}from"./chunk-L2Z3U5DT.js";import{g as I}from"./chunk-A7ZQXM6L.js";import"./chunk-6YC6D2A4.js";import"./chunk-A34XXWSO.js";import{$a as d,La as m,Ma as u,Na as O,Oa as E,Pa as R,Qa as f,Ra as a,Sa as o,Ta as C,W as p,X as _,Xa as x,Za as T,db as h,fb as V,gb as c,hb as v,ib as A,jb as y,kb as b,lb as w,nb as F,qa as s,ua as g,ya as S}from"./chunk-L36VNRBB.js";var ae=()=>({standalone:!0});function se(i,t){if(i&1&&(a(0,"div",5),c(1),o()),i&2){let e=d();s(),v(e.Message)}}function le(i,t){if(i&1){let e=x();a(0,"input",12),T("input",function(n){let l=p(e).$index,P=d(2);return _(P.autoFocusNext(n,l))}),o()}if(i&2){let e=t.$index;f("formControlName",e)}}function de(i,t){if(i&1&&(a(0,"p"),c(1),o()),i&2){let e=d(2);s(),A("OTP Resend After: ",e.displayTimer)}}function ce(i,t){if(i&1){let e=x();a(0,"button",13),T("click",function(){p(e);let n=d(2);return _(n.CheckOTP())}),c(1,"Verify OTP"),o()}}function me(i,t){i&1&&(a(0,"button",11),c(1,"Enter All Digits"),o())}function ue(i,t){if(i&1&&(a(0,"form",6)(1,"div",7),E(2,le,1,1,"input",8,O),o(),a(4,"div",9),m(5,de,2,1,"p"),m(6,ce,2,0,"button",10)(7,me,2,0,"button",11),o()()),i&2){let e=d();f("formGroup",e.OTPForm),s(2),R(e.digit.controls),s(3),u(e.ShowDisplayTime?5:-1),s(),u(e.OTPForm.valid?6:7)}}function pe(i,t){i&1&&(a(0,"p",19),c(1,"Email is required"),o())}function _e(i,t){i&1&&(a(0,"p",19),c(1,"Please enter valid email"),o())}function ge(i,t){if(i&1&&(m(0,pe,2,0,"p",19),m(1,_e,2,0,"p",19)),i&2){d();let e=h(1);u(e.errors!=null&&e.errors.required?0:-1),s(),u(e.errors!=null&&e.errors.email?1:-1)}}function fe(i,t){i&1&&(a(0,"p",19),c(1,"Password is required"),o())}function he(i,t){i&1&&(a(0,"p",19),c(1,"Password must have 5 characters "),o())}function xe(i,t){if(i&1&&(m(0,fe,2,0,"p",19),m(1,he,2,0,"p",19)),i&2){d();let e=h(7);u(e.errors!=null&&e.errors.required?0:-1),s(),u(e.errors!=null&&e.errors.minlength?1:-1)}}function Te(i,t){if(i&1){let e=x();a(0,"input",14,1),w("ngModelChange",function(n){p(e);let l=d();return b(l.recipient,n)||(l.recipient=n),_(n)}),o(),m(2,ge,2,2),a(3,"button",15),T("click",function(){p(e);let n=d();return _(n.SendOTP())}),c(4),o(),C(5,"br"),a(6,"input",16,2),w("ngModelChange",function(n){p(e);let l=d();return b(l.password,n)||(l.password=n),_(n)}),o(),a(8,"span")(9,"input",17),w("ngModelChange",function(n){p(e);let l=d();return b(l.showPassword,n)||(l.showPassword=n),_(n)}),o(),c(10," Show Password"),C(11,"br"),o(),m(12,xe,2,2),C(13,"br"),a(14,"button",18),c(15,"Submit"),o()}if(i&2){let e=h(1),r=h(7),n=d(),l=h(1);y("ngModel",n.recipient),s(2),u(e.invalid&&e.touched?2:-1),s(),V(n.OTPBTNTEXT==="Verified"?" btn btn-success":"btn btn-primary"),f("disabled",(e.errors==null?null:e.errors.email)||n.IsTimerActive||n.OTPBTNTEXT==="Verified"||(e.errors==null?null:e.errors.required)),s(),v(n.OTPBTNTEXT),s(2),f("type",n.showPassword?"text":"password"),y("ngModel",n.password),s(3),f("ngModelOptions",F(12,ae)),y("ngModel",n.showPassword),s(3),u(r.invalid&&r.touched?12:-1),s(2),f("disabled",l.invalid||n.OTPBTNTEXT!=="Verified")}}var re=class i{constructor(t,e,r,n,l,P){this.cdd=t;this.fb=e;this.router=r;this.nav=n;this.qService=l;this.login=P;this.OTPForm=this.fb.group({digit:this.fb.array(Array(6).fill("").map(()=>this.fb.control("",[M.required,M.pattern("[0-9]")])))})}AddUser(){let t=new q;t.setEmail=this.recipient,t.setPassword=this.password,this.qService.AddUser(t).subscribe(e=>{this.MyAlert("User Registered successfully"),setTimeout(()=>{this.nav.navigate(["/Login"],{queryParams:{redirect:"/quiz"}})},3e3)})}autoFocusNext(t,e){let r=t.target;r.value&&e<5&&r.parentElement.children[e+1].focus()}OTPForm;get digit(){return this.OTPForm.get("digit")}email=new oe;showTextBox=!1;IsTimerActive=!1;displayTimer="";seconds=60;timerInterval;ShowDisplayTime=!0;recipient="";OTPBTNTEXT="Get OTP";password="";MyAlert(t){this.Message=t,setTimeout(()=>{this.Message=""},5e3)}DisablesFor2minute(){this.seconds=180,this.IsTimerActive=!0,this.showTextBox=!0,this.ShowDisplayTime=!0,this.timerInterval=setInterval(()=>{this.seconds==0&&(this.IsTimerActive=!1,this.OTP=0,clearInterval(this.timerInterval),this.ShowDisplayTime=!1,this.showTextBox=!1),this.displayTimer=this.formatTime(this.seconds),this.seconds--},1e3)}formatTime(t){let e=Math.floor(t/60),r=t%60;return`0${e} : ${r<10?"0":""}${r}`}OTP=0;SendOTP(){this.email.recipient=this.recipient,this.email.subject="Verify Your Email Address",this.OTP=Math.floor(1e5+Math.random()*9e5),this.email.body=`Dear User,

 Thank you for registering with us! To complete your email varification,
    please use the One-Time Password (OTP) below:

    Your OTP: [${this.OTP}] 
 This OTP  is valid for the next 5 minutes. Please do not share it with anyone.

    If you did not initiate this request, please ignore this email or contact support immediately.

    Best Regards,
 Juned Maniyar

    pseudo8433@gmail.com`,this.email.purpose="register",this.cdd.sendOTPEmail(this.email).subscribe({next:t=>{t.started?(this.DisablesFor2minute(),console.log(t),this.MyAlert(t.messg),this.digit.controls.map(e=>e.setValue("")),this.showTextBox=!0):t.messg==="Account already exist"&&(this.MyAlert(t.messg),this.showTextBox=!1)},error:t=>{this.MyAlert(t.message)}})}Message="";showPassword=!1;getOtp(){return this.digit.controls.map(t=>t.value).join("")}CheckOTP(){this.getOtp()===this.OTP.toString()?(this.MyAlert("Email Verified Successfully"),this.showTextBox=!1,clearInterval(this.timerInterval),this.IsTimerActive=!1,this.OTPBTNTEXT="Verified"):this.MyAlert(" Invalid OTP, Please try again")}ngOnDestroy(){this.timerInterval&&clearInterval(this.timerInterval)}static \u0275fac=function(e){return new(e||i)(g(ne),g(ee),g(N),g(B),g(D),g(k))};static \u0275cmp=S({type:i,selectors:[["app-registration"]],decls:7,vars:2,consts:[["MyForm","ngForm"],["email","ngModel"],["pass","ngModel"],[1,"p-2","m-4","formbody",2,"height","100%","margin-bottom","20px",3,"ngSubmit"],[1,"m-4","text-center"],[1,"alert","alert-danger","text-center",2,"width","95%","color","red"],[1,"container",3,"formGroup"],["formArrayName","digit",1,"d-flex","justify-content-center","gap-2","mt-4"],["type","text","maxlength","1",1,"bordred","form-control","text-center","otp-box",3,"formControlName"],[1,"text-center","mt-3"],["button","button",1,"btn","btn-primary"],["disabled","",1,"btn","btn-secondary"],["type","text","maxlength","1",1,"bordred","form-control","text-center","otp-box",3,"input","formControlName"],["button","button",1,"btn","btn-primary",3,"click"],["type","email","placeholder","Enter unofficial Gmail","name","email","ngModel","","required","","email","",1,"p-2","m-2",3,"ngModelChange","ngModel"],["type","button",3,"click","disabled"],["placeholder","Enter password","name","password","required","","minlength","5",1,"p-2","m-1",3,"ngModelChange","type","ngModel"],["type","checkbox","name","showPAssword",1,"check",3,"ngModelChange","ngModelOptions","ngModel"],["type","submit",1,"btn","btn-success",3,"disabled"],[2,"color","red"]],template:function(e,r){if(e&1){let n=x();a(0,"form",3,0),T("ngSubmit",function(){return p(n),_(r.AddUser())}),a(2,"h2",4),c(3,"Registration"),o(),m(4,se,2,1,"div",5),m(5,ue,8,3,"form",6)(6,Te,16,13),o()}e&2&&(s(4),u(r.Message?4:-1),s(),u(r.showTextBox?5:6))},dependencies:[te,X,L,j,W,G,J,K,Z,H,U,z,ie,Q,$,Y,I],styles:[".otp-box[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:center;width:40px;height:35px;flex-wrap:wrap;align-items:center;font-size:20pxem;border:1px solid black;border-radius:.5rem}.otp-box[_ngcontent-%COMP%]:focus{border:2px solid blue;outline:none;box-shadow:0 0 5px #00f}.formbody[_ngcontent-%COMP%]{background-color:#e7e7e7;font-size:1.1em;margin:15%;text-align:center;display:flex;flex-direction:column}.check[_ngcontent-%COMP%]{width:25px;height:25px}@media (max-width: 480px){.formbody[_ngcontent-%COMP%]{font-size:.7em}.check[_ngcontent-%COMP%]{width:15px;height:15px}}"]})};export{re as Registration};
